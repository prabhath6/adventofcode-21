(ns adventofcode-21.core)


;; Day1
;; Part1
(def data '(199
             227
             229
             230
             233
             228
             231
             226
             237
             259
             262
             265
             266
             265
             269
             276
             278
             279
             281
             287
             305
             316
             314
             320
             313
             314
             315
             329
             346
             357
             370
             369
             360
             384
             383
             401
             402
             403
             404
             403
             406
             408
             406
             401
             393
             395
             416
             418
             408
             411
             412
             416
             417
             404
             421
             436
             437
             436
             420
             388
             405
             403
             371
             376
             378
             374
             378
             377
             403
             411
             444
             424
             417
             416
             419
             436
             415
             413
             429
             446
             462
             463
             464
             467
             466
             475
             483
             478
             487
             488
             469
             470
             472
             473
             460
             463
             465
             477
             487
             508
             506
             509
             512
             513
             519
             525
             531
             498
             506
             504
             506
             507
             509
             510
             512
             537
             553
             536
             533
             524
             525
             526
             527
             530
             531
             533
             537
             538
             537
             539
             544
             552
             550
             576
             560
             556
             561
             552
             560
             572
             573
             572
             571
             573
             578
             581
             582
             578
             541
             546
             537
             545
             556
             565
             566
             571
             561
             573
             579
             578
             581
             600
             603
             604
             597
             598
             599
             598
             599
             580
             585
             586
             596
             597
             602
             593
             598
             599
             604
             608
             609
             616
             615
             613
             622
             625
             620
             632
             636
             628
             633
             640
             621
             620
             638
             646
             647
             648
             647
             654
             655
             663
             652
             664
             668
             669
             668
             663
             667
             659
             658
             666
             670
             685
             703
             706
             705
             706
             727
             730
             729
             735
             743
             749
             750
             751
             756
             774
             776
             767
             778
             777
             790
             791
             794
             798
             801
             804
             812
             818
             819
             818
             821
             825
             818
             829
             832
             835
             849
             848
             863
             859
             863
             871
             870
             869
             873
             875
             878
             874
             896
             903
             890
             891
             905
             912
             913
             911
             917
             941
             943
             944
             940
             943
             945
             947
             948
             953
             930
             932
             933
             948
             936
             937
             941
             947
             952
             957
             951
             953
             954
             958
             979
             982
             971
             974
             979
             984
             988
             989
             986
             987
             992
             998
             1013
             1024
             1022
             1023
             1014
             1019
             1042
             1048
             1047
             1060
             1056
             1067
             1054
             1053
             1061
             1063
             1068
             1074
             1104
             1105
             1107
             1119
             1126
             1127
             1129
             1143
             1145
             1146
             1151
             1159
             1183
             1185
             1192
             1183
             1185
             1182
             1180
             1198
             1215
             1221
             1224
             1227
             1230
             1262
             1289
             1291
             1294
             1297
             1300
             1303
             1321
             1323
             1329
             1331
             1341
             1362
             1369
             1370
             1388
             1389
             1393
             1407
             1386
             1380
             1381
             1378
             1398
             1402
             1399
             1422
             1433
             1449
             1451
             1449
             1462
             1454
             1455
             1452
             1471
             1472
             1487
             1477
             1459
             1463
             1461
             1463
             1473
             1489
             1482
             1516
             1527
             1521
             1522
             1527
             1529
             1531
             1538
             1550
             1553
             1548
             1549
             1545
             1548
             1543
             1546
             1549
             1572
             1576
             1581
             1575
             1584
             1602
             1604
             1605
             1606
             1611
             1610
             1623
             1618
             1614
             1622
             1613
             1608
             1611
             1638
             1632
             1643
             1649
             1652
             1655
             1652
             1653
             1654
             1658
             1659
             1661
             1667
             1695
             1710
             1719
             1726
             1727
             1725
             1726
             1736
             1741
             1763
             1752
             1769
             1770
             1767
             1768
             1769
             1771
             1799
             1798
             1810
             1813
             1816
             1826
             1837
             1842
             1841
             1848
             1853
             1823
             1836
             1835
             1837
             1836
             1839
             1838
             1840
             1841
             1839
             1843
             1844
             1862
             1873
             1877
             1880
             1882
             1881
             1895
             1891
             1896
             1899
             1893
             1894
             1892
             1894
             1895
             1921
             1920
             1922
             1928
             1925
             1933
             1943
             1942
             1936
             1941
             1919
             1912
             1914
             1922
             1918
             1934
             1932
             1946
             1949
             1955
             1964
             1974
             1977
             1978
             1983
             1984
             1986
             1990
             2005
             2022
             2026
             2032
             2031
             2029
             2031
             2035
             2041
             2042
             2043
             2053
             2054
             2058
             2062
             2063
             2055
             2049
             2021
             2022
             2054
             2052
             2084
             2076
             2079
             2090
             2088
             2093
             2095
             2093
             2091
             2089
             2095
             2096
             2102
             2127
             2129
             2132
             2117
             2125
             2131
             2132
             2126
             2134
             2140
             2137
             2138
             2136
             2137
             2141
             2153
             2152
             2170
             2177
             2147
             2159
             2161
             2160
             2173
             2176
             2194
             2205
             2206
             2213
             2231
             2232
             2242
             2243
             2217
             2224
             2225
             2230
             2226
             2214
             2212
             2227
             2230
             2237
             2238
             2241
             2264
             2283
             2288
             2308
             2309
             2311
             2312
             2314
             2316
             2317
             2318
             2321
             2326
             2324
             2325
             2321
             2324
             2322
             2325
             2327
             2335
             2369
             2370
             2374
             2375
             2344
             2347
             2348
             2341
             2346
             2355
             2356
             2371
             2368
             2370
             2375
             2378
             2379
             2370
             2363
             2365
             2366
             2363
             2364
             2372
             2374
             2392
             2399
             2397
             2384
             2400
             2401
             2402
             2401
             2400
             2402
             2412
             2422
             2423
             2426
             2424
             2425
             2421
             2422
             2440
             2441
             2451
             2442
             2443
             2444
             2446
             2451
             2452
             2450
             2458
             2457
             2490
             2496
             2506
             2507
             2508
             2511
             2531
             2536
             2537
             2539
             2529
             2530
             2561
             2562
             2592
             2595
             2584
             2601
             2603
             2589
             2586
             2588
             2586
             2596
             2613
             2616
             2618
             2621
             2629
             2637
             2638
             2619
             2621
             2619
             2631
             2621
             2619
             2624
             2628
             2634
             2636
             2637
             2626
             2632
             2623
             2630
             2629
             2630
             2633
             2620
             2629
             2635
             2614
             2617
             2612
             2613
             2609
             2601
             2604
             2611
             2602
             2607
             2611
             2639
             2646
             2647
             2618
             2613
             2614
             2635
             2642
             2649
             2653
             2652
             2628
             2629
             2631
             2636
             2639
             2649
             2665
             2667
             2666
             2665
             2668
             2672
             2673
             2675
             2693
             2694
             2696
             2701
             2702
             2703
             2700
             2716
             2718
             2719
             2718
             2719
             2722
             2723
             2715
             2726
             2737
             2757
             2758
             2759
             2762
             2760
             2765
             2759
             2763
             2764
             2774
             2785
             2786
             2802
             2803
             2802
             2824
             2833
             2834
             2830
             2832
             2842
             2828
             2829
             2836
             2838
             2813
             2811
             2798
             2799
             2796
             2805
             2808
             2807
             2811
             2812
             2811
             2812
             2793
             2787
             2802
             2805
             2804
             2822
             2825
             2837
             2835
             2842
             2838
             2849
             2840
             2841
             2853
             2854
             2863
             2877
             2886
             2864
             2866
             2846
             2860
             2840
             2842
             2844
             2866
             2867
             2870
             2856
             2860
             2861
             2860
             2872
             2877
             2881
             2883
             2881
             2883
             2880
             2881
             2882
             2880
             2902
             2903
             2904
             2937
             2939
             2938
             2945
             2954
             2950
             2966
             2967
             2976
             2980
             2982
             2976
             2986
             2997
             2996
             2994
             3004
             3007
             3008
             3016
             3014
             3054
             3078
             3095
             3114
             3115
             3120
             3107
             3109
             3124
             3140
             3144
             3150
             3163
             3165
             3164
             3158
             3172
             3175
             3174
             3184
             3188
             3198
             3193
             3224
             3226
             3227
             3252
             3273
             3280
             3289
             3291
             3290
             3291
             3279
             3281
             3282
             3281
             3298
             3302
             3289
             3304
             3295
             3312
             3314
             3327
             3328
             3337
             3348
             3349
             3340
             3348
             3351
             3350
             3351
             3350
             3345
             3339
             3343
             3344
             3329
             3354
             3356
             3358
             3363
             3365
             3373
             3376
             3383
             3384
             3388
             3389
             3390
             3397
             3398
             3401
             3409
             3411
             3412
             3411
             3418
             3428
             3430
             3432
             3418
             3410
             3418
             3424
             3425
             3426
             3430
             3439
             3441
             3422
             3423
             3425
             3426
             3428
             3429
             3436
             3448
             3447
             3443
             3445
             3468
             3482
             3483
             3499
             3506
             3513
             3518
             3523
             3524
             3525
             3529
             3532
             3529
             3565
             3577
             3576
             3577
             3576
             3539
             3557
             3554
             3563
             3562
             3564
             3565
             3586
             3583
             3590
             3589
             3580
             3581
             3574
             3599
             3597
             3609
             3610
             3611
             3614
             3613
             3611
             3612
             3611
             3598
             3596
             3597
             3585
             3568
             3569
             3550
             3561
             3563
             3551
             3552
             3555
             3553
             3554
             3553
             3552
             3555
             3557
             3560
             3585
             3591
             3604
             3609
             3640
             3641
             3645
             3644
             3643
             3646
             3644
             3664
             3653
             3660
             3667
             3664
             3665
             3668
             3670
             3649
             3640
             3639
             3647
             3654
             3650
             3648
             3654
             3651
             3652
             3653
             3654
             3655
             3671
             3660
             3671
             3675
             3679
             3680
             3681
             3686
             3690
             3691
             3693
             3695
             3698
             3697
             3699
             3708
             3712
             3714
             3712
             3711
             3716
             3731
             3732
             3736
             3753
             3755
             3756
             3767
             3747
             3746
             3733
             3711
             3722
             3718
             3721
             3722
             3723
             3724
             3727
             3731
             3732
             3741
             3743
             3750
             3751
             3738
             3741
             3739
             3740
             3756
             3755
             3751
             3750
             3755
             3757
             3773
             3778
             3781
             3782
             3768
             3772
             3766
             3770
             3778
             3792
             3798
             3801
             3803
             3801
             3812
             3833
             3873
             3868
             3865
             3866
             3906
             3910
             3897
             3907
             3910
             3898
             3914
             3917
             3908
             3912
             3920
             3934
             3930
             3934
             3935
             3937
             3942
             3943
             3948
             3964
             3978
             3985
             3986
             3993
             3995
             4014
             4021
             4024
             4025
             4024
             4027
             4028
             4043
             4047
             4049
             4036
             4039
             4038
             4037
             4045
             4040
             4041
             4043
             4035
             4046
             4063
             4054
             4055
             4064
             4067
             4060
             4061
             4062
             4069
             4070
             4063
             4064
             4077
             4065
             4074
             4076
             4078
             4091
             4100
             4104
             4105
             4106
             4107
             4115
             4110
             4112
             4113
             4114
             4115
             4092
             4093
             4107
             4109
             4108
             4112
             4143
             4144
             4145
             4146
             4145
             4144
             4126
             4130
             4134
             4149
             4151
             4161
             4162
             4160
             4146
             4170
             4188
             4196
             4194
             4193
             4196
             4197
             4198
             4200
             4205
             4218
             4228
             4216
             4224
             4226
             4241
             4245
             4247
             4251
             4245
             4244
             4266
             4259
             4262
             4269
             4270
             4275
             4281
             4298
             4305
             4309
             4311
             4325
             4328
             4346
             4347
             4357
             4360
             4359
             4357
             4391
             4396
             4391
             4397
             4395
             4405
             4410
             4412
             4433
             4420
             4421
             4422
             4423
             4431
             4437
             4447
             4451
             4458
             4457
             4458
             4456
             4455
             4458
             4460
             4431
             4432
             4431
             4441
             4444
             4436
             4408
             4406
             4414
             4415
             4413
             4422
             4449
             4430
             4428
             4397
             4395
             4396
             4398
             4396
             4399
             4406
             4413
             4422
             4421
             4429
             4431
             4430
             4462
             4460
             4480
             4482
             4486
             4484
             4483
             4497
             4493
             4496
             4506
             4504
             4497
             4498
             4503
             4513
             4525
             4533
             4547
             4560
             4561
             4563
             4562
             4572
             4571
             4575
             4557
             4561
             4562
             4550
             4552
             4543
             4537
             4534
             4542
             4561
             4563
             4562
             4583
             4582
             4591
             4592
             4597
             4601
             4599
             4600
             4610
             4601
             4612
             4630
             4616
             4619
             4623
             4624
             4636
             4638
             4645
             4651
             4655
             4660
             4659
             4658
             4657
             4658
             4661
             4670
             4665
             4656
             4664
             4666
             4667
             4669
             4696
             4701
             4712
             4711
             4719
             4679
             4680
             4686
             4684
             4685
             4689
             4682
             4686
             4688
             4687
             4688
             4687
             4693
             4672
             4670
             4667
             4673
             4643
             4644
             4653
             4668
             4669
             4672
             4685
             4663
             4665
             4672
             4696
             4698
             4701
             4699
             4687
             4690
             4687
             4684
             4685
             4687
             4689
             4685
             4692
             4690
             4696
             4702
             4703
             4704
             4717
             4718
             4719
             4711
             4717
             4719
             4726
             4722
             4736
             4735
             4739
             4748
             4741
             4738
             4736
             4737
             4736
             4740
             4748
             4749
             4757
             4760
             4768
             4754
             4756
             4772
             4773
             4775
             4770
             4766
             4769
             4762
             4771
             4773
             4775
             4776
             4778
             4782
             4770
             4763
             4765
             4764
             4765
             4764
             4777
             4780
             4786
             4797
             4803
             4812
             4811
             4818
             4823
             4820
             4821
             4831
             4834
             4862
             4865
             4856
             4857
             4863
             4860
             4861
             4858
             4846
             4848
             4852
             4853
             4854
             4856
             4832
             4833
             4832
             4830
             4826
             4833
             4851
             4852
             4855
             4856
             4857
             4852
             4854
             4860
             4863
             4887
             4878
             4879
             4880
             4893
             4888
             4891
             4892
             4896
             4897
             4900
             4905
             4903
             4909
             4927
             4942
             4946
             4952
             4970
             4971
             4987
             4990
             4991
             4990
             4989
             4988
             4989
             4995
             4996
             5004
             5003
             5005
             5009
             4997
             4981
             4977
             4979
             4982
             4984
             4994
             5005
             5009
             5008
             5036
             5034
             5033
             5030
             5032
             5034
             5030
             5031
             5034
             5070
             5072
             5071
             5073
             5077
             5078
             5070
             5084
             5085
             5091
             5071
             5080
             5075
             5070
             5067
             5072
             5075
             5082
             5085
             5091
             5104
             5120
             5123
             5122
             5105
             5120
             5128
             5116
             5118
             5122
             5120
             5140
             5142
             5145
             5148
             5152
             5153
             5154
             5157
             5172
             5179
             5177
             5185
             5191
             5200
             5201
             5207
             5205
             5206
             5198
             5205
             5186
             5188
             5197
             5194
             5203
             5204
             5205
             5208
             5214
             5220
             5219
             5224
             5227
             5241
             5233
             5253
             5283
             5287
             5291
             5289
             5296
             5297
             5294
             5288
             5289
             5290
             5278
             5290
             5288
             5294
             5295
             5294
             5292
             5289
             5299
             5283
             5285
             5290
             5289
             5291
             5302
             5304
             5305
             5315
             5316
             5323
             5337
             5341
             5345
             5346
             5358
             5361
             5367
             5348
             5354
             5344
             5339
             5342
             5341
             5354
             5356
             5355
             5354
             5355
             5356
             5342
             5348
             5350
             5351
             5355
             5378
             5380
             5404
             5405
             5407
             5417
             5419
             5411
             5412
             5413
             5416
             5420
             5391
             5377
             5386
             5387
             5390
             5383
             5385
             5384
             5390
             5389
             5390
             5409
             5414
             5424
             5427
             5428
             5430
             5443
             5435
             5430
             5427
             5428
             5422
             5452
             5460
             5464
             5465
             5472
             5473
             5481
             5480
             5481
             5482
             5483
             5493
             5495
             5492
             5501
             5517
             5519
             5527
             5532
             5529
             5532
             5542
             5532
             5550
             5551
             5560
             5543
             5549
             5555
             5554
             5555
             5552
             5562
             5563
             5564
             5566
             5568
             5571
             5549
             5556
             5557
             5563
             5564
             5567
             5563
             5570
             5559
             5580
             5585
             5568
             5569
             5562
             5578
             5579
             5565
             5567
             5583
             5584
             5592
             5590
             5593
             5595
             5594
             5597
             5582
             5588
             5594
             5596
             5598
             5597
             5595
             5605
             5593
             5590
             5599
             5603
             5597
             5632
             5621
             5624
             5628
             5634
             5662
             5663
             5666
             5674
             5678
             5677
             5678
             5679
             5680
             5681
             5687
             5690
             5685
             5684
             5683
             5689
             5690
             5691
             5689
             5694
             5698
             5701
             5698
             5733
             5757
             5767
             5794
             5812
             5804
             5802
             5810
             5826
             5856
             5855
             5860
             5861
             5846
             5865
             5885
             5874
             5883
             5888
             5892
             5894
             5877
             5840
             5841
             5814
             5815
             5818
             5821
             5822
             5819
             5818
             5842
             5849
             5850
             5851
             5854
             5856
             5854
             5851
             5864
             5866
             5867
             5871
             5874
             5879
             5888
             5886
             5890
             5894
             5889
             5875
             5863
             5847
             5857
             5853
             5858
             5859
             5862
             5867
             5862
             5866
             5874
             5875
             5894
             5897
             5877
             5886
             5887
             5891
             5881
             5886
             5885
             5886
             5887
             5888
             5892
             5891
             5903
             5902
             5901
             5902
             5903
             5908
             5905
             5912
             5914
             5920
             5927
             5916
             5917
             5918
             5921
             5931
             5939
             5942
             5943
             5949
             5962
             5990
             5985
             5982
             5980
             5979
             5990
             5995
             6012
             6029
             6038
             6050
             6051
             6057
             6052
             6061
             6060
             6050
             6058
             6059
             6060
             6064
             6065
             6092
             6091
             6090
             6089
             6085
             6101
             6107
             6110
             6109
             6120
             6117
             6110))


(defn increase? [pair]
  (let [start-val (first pair)
        end-val (last pair)]
    (> (- end-val start-val) 0)))


(count (filter #(true? %1) (map increase? (partition 2 1 data))))


;; Part2
(count
  (filter #(true? %1)
          (map increase?
               (partition 2 1
                          (map #(apply + %1)
                               (partition 3 1 data))))))



;; Day2
(def day2-data
  "forward 5\nforward 2\nforward 9\ndown 2\nforward 9\nforward 3\nforward 2\ndown 6\nforward 3\nforward 3\ndown 3\ndown 3\nforward 8\ndown 5\nforward 7\nforward 9\nforward 9\nforward 6\nforward 9\nforward 3\nforward 3\nforward 1\nforward 7\ndown 6\nforward 7\nforward 4\ndown 3\ndown 1\nforward 4\ndown 7\ndown 2\ndown 8\nforward 9\ndown 5\ndown 2\nforward 6\nup 4\ndown 3\ndown 1\ndown 6\ndown 7\nforward 6\nup 2\nforward 2\ndown 9\ndown 3\nforward 7\nup 3\nup 7\nforward 8\nforward 7\ndown 4\nup 8\nup 1\nforward 4\ndown 6\nforward 9\nforward 3\ndown 1\ndown 1\nforward 2\nforward 4\nforward 3\nup 2\nforward 1\ndown 8\nforward 4\ndown 5\nforward 9\nup 1\nforward 3\nforward 6\nup 8\nforward 1\nforward 7\nup 9\ndown 3\nup 7\ndown 1\nforward 5\nforward 3\nforward 7\ndown 5\ndown 1\ndown 2\ndown 4\ndown 5\ndown 5\ndown 8\nup 9\ndown 7\ndown 7\ndown 6\nforward 3\nforward 5\nforward 1\nforward 8\nup 4\ndown 8\ndown 3\ndown 1\ndown 9\ndown 3\ndown 9\ndown 8\ndown 2\nforward 1\nforward 7\nforward 1\ndown 3\ndown 1\nup 3\ndown 6\nforward 6\nforward 6\ndown 8\nforward 3\ndown 1\nforward 2\ndown 4\ndown 7\nup 8\nforward 4\ndown 4\nup 1\nforward 6\ndown 6\nforward 5\nforward 9\nup 5\ndown 3\nup 9\ndown 6\nup 3\ndown 9\ndown 4\ndown 2\nforward 3\ndown 6\ndown 7\ndown 9\nforward 7\nforward 2\nforward 5\nup 6\ndown 8\nforward 1\ndown 2\nforward 8\ndown 5\ndown 2\nup 4\nforward 9\nup 4\ndown 4\ndown 2\nforward 3\nup 2\ndown 5\ndown 9\nup 4\nforward 9\ndown 5\ndown 2\ndown 2\nforward 9\nup 9\nforward 6\nup 7\ndown 2\nforward 8\ndown 1\nforward 2\ndown 3\nup 6\ndown 4\nforward 5\nup 4\nforward 5\nforward 9\nforward 9\nforward 5\ndown 1\ndown 7\nforward 6\nforward 9\nforward 3\nforward 4\nup 8\ndown 1\nup 1\ndown 3\nup 1\ndown 5\nforward 6\nup 5\nup 6\ndown 9\nforward 7\ndown 7\nforward 1\nforward 2\nup 4\nforward 4\ndown 9\nup 4\ndown 6\nforward 1\nup 9\nforward 2\ndown 8\nforward 6\nforward 6\ndown 6\nforward 5\nforward 9\nup 8\ndown 4\nforward 8\nup 6\ndown 4\nup 9\nforward 2\ndown 8\ndown 6\nforward 2\ndown 3\nforward 1\nforward 3\nforward 2\nup 4\ndown 6\nup 6\ndown 4\ndown 2\nforward 1\nup 7\nforward 9\nforward 9\nforward 7\ndown 1\ndown 9\nforward 5\nforward 4\nforward 1\nforward 4\ndown 5\nforward 6\nforward 8\ndown 5\ndown 7\nup 2\nup 1\nforward 5\ndown 5\ndown 1\ndown 5\ndown 8\ndown 8\ndown 5\nforward 7\ndown 6\ndown 2\nforward 9\nforward 1\nforward 3\nforward 4\nup 3\ndown 4\nup 7\nforward 8\nforward 7\nup 4\ndown 9\nforward 7\nforward 6\nup 1\ndown 1\nup 6\ndown 5\nup 1\nforward 2\ndown 2\nforward 3\ndown 6\nup 5\nup 4\ndown 8\ndown 5\ndown 3\ndown 4\nup 3\ndown 3\ndown 2\ndown 7\nup 2\ndown 8\nforward 5\nup 1\nforward 9\ndown 6\ndown 6\ndown 8\nup 4\nforward 9\nforward 8\nup 7\ndown 9\ndown 4\nforward 9\nforward 9\nup 2\ndown 1\nforward 1\nforward 4\nforward 2\nforward 9\ndown 1\ndown 3\ndown 1\ndown 3\nup 5\ndown 2\nforward 4\ndown 2\nforward 1\ndown 6\nup 9\ndown 3\nforward 1\nforward 5\nforward 8\ndown 5\ndown 6\ndown 9\nforward 4\ndown 7\nup 8\nforward 8\ndown 9\nforward 6\ndown 8\nup 3\nforward 4\nup 9\ndown 7\nup 7\nforward 6\nforward 1\nup 9\ndown 7\nup 7\ndown 5\nforward 6\nup 7\ndown 8\ndown 8\nforward 4\nup 4\nforward 1\nforward 6\ndown 4\nup 9\nforward 4\nup 1\nup 8\nup 6\nforward 9\nforward 4\nforward 7\nup 1\ndown 5\nup 5\nup 5\nforward 4\ndown 9\nup 8\ndown 6\ndown 3\ndown 6\nforward 2\nup 1\nforward 3\nup 8\ndown 1\nforward 5\ndown 9\nforward 4\nup 5\nforward 3\nforward 2\ndown 8\ndown 9\nup 6\ndown 9\ndown 7\nforward 5\nforward 4\nforward 9\nup 8\nforward 3\ndown 7\nforward 9\ndown 8\nforward 4\nforward 8\nup 9\nup 9\ndown 6\nforward 5\nforward 5\nforward 5\nup 2\nup 2\nup 1\ndown 6\nforward 2\nforward 2\ndown 8\ndown 6\nup 2\nforward 1\ndown 1\nup 5\nforward 7\ndown 2\nforward 1\nforward 3\ndown 5\ndown 7\nforward 8\nforward 4\nforward 9\nup 1\nup 7\nup 9\nforward 3\nup 1\nforward 6\nforward 3\nforward 9\nup 9\ndown 6\nforward 8\nup 6\ndown 9\nforward 3\nforward 7\ndown 9\nforward 4\nforward 5\nforward 7\ndown 1\ndown 4\ndown 3\nforward 6\ndown 3\nforward 7\nforward 8\ndown 1\nforward 3\ndown 4\nup 7\nforward 2\nforward 8\ndown 6\nup 3\ndown 2\nforward 9\nforward 5\nforward 7\nup 2\nup 6\ndown 9\nforward 1\nup 5\nforward 1\nup 6\nup 2\nup 1\nforward 6\ndown 8\nforward 7\ndown 5\nforward 3\ndown 9\ndown 4\nforward 3\ndown 1\nup 1\nup 7\nforward 4\ndown 6\nforward 3\nforward 2\ndown 8\nforward 9\nforward 6\nup 3\ndown 3\ndown 1\ndown 7\nup 8\nup 2\nup 8\nforward 6\nforward 8\nforward 6\nforward 4\ndown 6\nforward 6\nforward 6\nforward 1\ndown 2\nforward 2\nforward 6\ndown 1\nup 6\nforward 3\nforward 9\nforward 6\ndown 2\nforward 2\nup 4\ndown 2\nup 4\nforward 2\nforward 2\nforward 3\nup 1\nforward 8\nforward 3\nforward 3\nforward 1\ndown 5\ndown 9\nforward 4\ndown 1\nforward 5\nforward 2\ndown 5\nforward 6\nforward 3\nup 3\nforward 6\nforward 9\nforward 5\ndown 2\ndown 2\ndown 7\nforward 8\ndown 1\ndown 5\ndown 9\nup 3\nup 5\nup 4\nforward 3\ndown 9\ndown 2\ndown 8\ndown 5\ndown 2\nforward 4\nup 3\ndown 5\nup 3\ndown 8\ndown 7\nup 1\nforward 2\nforward 1\ndown 2\nup 1\nup 5\ndown 8\ndown 3\nup 9\nforward 2\ndown 8\ndown 4\ndown 3\nforward 3\nforward 7\nup 1\ndown 9\nforward 1\ndown 6\nup 3\nup 5\ndown 6\nup 4\nforward 7\nup 4\nforward 9\nup 4\nforward 4\ndown 7\ndown 2\ndown 8\nup 3\ndown 7\ndown 4\nup 5\nforward 8\ndown 8\ndown 1\nforward 7\nup 9\ndown 5\nup 8\ndown 1\nup 3\nforward 8\nup 4\ndown 1\nup 1\nup 7\nforward 3\nforward 6\nforward 5\nforward 2\ndown 4\nforward 2\ndown 7\nup 7\nup 6\ndown 4\nforward 4\nforward 9\nforward 7\ndown 4\ndown 6\nforward 5\ndown 2\ndown 6\ndown 2\ndown 2\nforward 9\nup 5\nforward 9\ndown 3\ndown 6\ndown 1\nforward 5\ndown 5\nforward 7\nforward 9\nup 8\nforward 6\ndown 6\ndown 2\nforward 8\nforward 5\nup 9\nup 4\nforward 1\nforward 2\nforward 2\nup 9\ndown 6\nforward 6\nforward 8\nup 5\nup 7\nforward 4\ndown 3\nforward 1\nup 6\nup 9\nforward 6\nup 8\nforward 5\ndown 4\nforward 1\ndown 3\nforward 1\nforward 6\nforward 2\nup 4\ndown 6\nforward 9\ndown 2\nforward 4\ndown 4\nforward 3\ndown 5\ndown 2\nforward 2\nforward 2\nup 1\nforward 1\ndown 7\ndown 8\nup 6\nforward 8\nforward 5\nforward 8\ndown 6\nforward 5\ndown 3\nup 3\nforward 4\nup 9\nforward 8\nforward 4\ndown 3\nforward 6\nup 6\ndown 2\ndown 7\ndown 3\ndown 2\ndown 8\nforward 5\ndown 9\nup 6\ndown 6\nforward 8\ndown 1\nforward 8\ndown 1\ndown 1\nforward 3\nforward 9\ndown 6\nforward 7\ndown 4\nforward 1\nforward 4\nforward 3\ndown 6\nforward 5\ndown 5\nforward 1\nforward 3\nforward 8\ndown 9\nup 8\nup 6\nup 6\nforward 2\nforward 9\ndown 4\ndown 8\nforward 6\nup 1\ndown 2\ndown 6\nforward 6\nforward 2\nup 8\nforward 6\ndown 9\ndown 1\nforward 7\nforward 6\nforward 5\nforward 6\ndown 6\nup 7\ndown 9\nforward 9\nforward 3\nforward 5\ndown 4\ndown 1\ndown 7\nup 3\nup 7\nforward 6\nforward 8\ndown 7\ndown 4\nforward 7\ndown 6\nup 1\nforward 4\ndown 2\nforward 4\nforward 3\nforward 4\nforward 4\nup 3\ndown 8\ndown 4\ndown 1\ndown 8\ndown 3\nup 9\ndown 4\nforward 7\ndown 6\nup 2\ndown 8\nup 9\ndown 6\nforward 1\ndown 3\nforward 9\ndown 9\nforward 1\ndown 5\nup 5\nup 1\nforward 8\ndown 8\ndown 9\ndown 5\ndown 2\ndown 5\nforward 3\ndown 9\nforward 4\nforward 4\nup 2\nforward 8\nforward 4\nforward 1\ndown 5\nforward 5\ndown 5\nforward 6\nforward 4\nup 5\ndown 9\nup 3\nup 8\nforward 5\nforward 9\nup 6\nforward 6\ndown 5\nforward 7\ndown 8\ndown 7\ndown 9\nforward 4\ndown 8\nforward 4\ndown 5\nforward 6\nforward 4\ndown 7\ndown 5\nforward 4\ndown 3\nup 4\nforward 3\nup 9\ndown 8\nforward 9\nforward 6\nforward 9\ndown 1\nforward 2\nup 5\ndown 9\ndown 2\ndown 9\nup 8\nforward 7\nforward 8\nforward 4\ndown 1\nup 8\nforward 8\ndown 8\ndown 4\nforward 9\ndown 3\nforward 7\nforward 9\ndown 5\nforward 7\nforward 1\nforward 5\nforward 2\ndown 4\nforward 7\ndown 6\nforward 3\ndown 9\nforward 3\ndown 5\nup 6\nup 3\nforward 1\nup 9\ndown 1\nforward 2\ndown 8\ndown 7\nup 9\nup 2\ndown 5\nup 9\nforward 9\nforward 9\ndown 1\nforward 5\nup 5\nforward 1\nup 1\ndown 3\nforward 3\ndown 3\nforward 3\nup 5\nup 4\ndown 7\ndown 7\ndown 4\nforward 7\ndown 6\nforward 1\nup 1\ndown 8\nforward 4\ndown 3\nforward 9\nup 6\nforward 6\nforward 3\nup 9\ndown 9\nforward 4\nup 5\ndown 3\ndown 8\ndown 3\ndown 3\nforward 4\nforward 6\nforward 4\nup 2\nup 3\nup 5\ndown 5\ndown 6\nforward 5\nforward 4\ndown 1\ndown 2\nup 8\ndown 2\ndown 1\nup 4\nforward 5\nforward 8\nforward 8\nforward 5\ndown 3\nforward 4\nup 8\nforward 7\nforward 4\ndown 9\ndown 6\nforward 2\ndown 7\nforward 6\nup 7\nup 1\nup 4\nforward 2\nforward 9\nforward 7\nup 5\nforward 2\nup 5\nforward 1\nforward 2\nforward 4\ndown 6\nforward 2\nup 6\nup 7\nforward 3\nforward 2\nforward 6\nforward 4\nforward 9\nforward 6\nup 6\nforward 5\nup 7\nup 5\ndown 6\ndown 2\ndown 1\nforward 7\ndown 5\ndown 1\ndown 7\nforward 8\nforward 8\nforward 5\ndown 9\nforward 6")


;; part 1
(defn convert-to-ints [vals]
  (let [f-val (first vals)
        l-val (Integer/parseInt (last vals))]
    [f-val l-val]))


(def day2-formatted-data (map convert-to-ints
                              (map #(clojure.string/split %1 #" ")
                                   (map clojure.string/trim (clojure.string/split-lines day2-data)))))


(defn reduce-me-to-nothing [curr-val [direction distance]]
  (cond
    (= direction "forward") (update curr-val :forward + distance)
    (= direction "down") (update curr-val :depth + distance)
    (= direction "up") (update curr-val :depth - distance)))


(let [final-data (reduce reduce-me-to-nothing {:forward 0 :depth 0} day2-formatted-data)]
  (* (:forward final-data) (:depth final-data)))


;; part 2
(defn reduce-me-to-nothing-part2 [curr-val [direction distance]]
  (cond
    (= direction "forward") (let [updated-map (update curr-val :forward + distance)]
                              (assoc updated-map :depth (+ (:depth updated-map) (* (:aim updated-map) distance))))
    (= direction "down") (update curr-val :aim + distance)
    (= direction "up") (update curr-val :aim - distance)))


(let [final-data (reduce reduce-me-to-nothing-part2 {:forward 0 :depth 0 :aim 0} day2-formatted-data)]
  (* (:forward final-data) (:depth final-data)))


;; Day 3
;; Part 1

(def day3-data
  "110000000001\n010011111011\n111000011110\n110101011110\n100000010100\n000101101111\n110100101000\n011100010001\n101001011011\n011000001100\n111101001011\n010001100100\n100101011010\n111101110101\n101001111100\n010010010101\n011100011000\n010110011101\n110001110101\n001111000010\n111011001011\n111111111110\n010000000100\n001011111101\n100111110101\n011011110100\n110101000100\n111010001110\n110101001011\n011100100110\n011100001001\n101001111101\n111111000010\n010010001100\n110010011001\n010100010010\n011010010000\n101111000100\n001010100101\n100010010100\n001000000110\n000011110100\n101101100001\n111100000111\n011010001110\n010110001000\n111101111010\n001001010111\n011001010011\n000111000010\n000010110001\n101000010111\n111010000100\n111001110111\n000000110001\n011111000110\n010110010111\n110100001001\n101100110110\n100111111000\n110000110000\n110110111101\n110011011100\n010001010010\n011011000101\n000001100010\n011001101001\n000111111011\n111000001101\n110100000101\n011000011011\n100101100110\n001001000001\n111011011010\n010101110110\n100011100000\n100000001011\n110101111001\n000101001000\n110111111010\n011001111111\n101000000101\n101000011111\n010010000111\n101101111100\n101110100001\n100111100101\n101111001100\n110101001111\n011100001111\n010000011110\n000010111111\n011110100101\n100010010110\n011101110011\n000000010111\n110111000110\n100110010100\n011110101111\n101101000111\n111111011100\n110000100010\n010110001010\n011001000100\n111001100011\n111101110100\n000011011100\n110011010001\n110011100110\n100000011110\n100100000010\n001000100001\n011000011111\n001001101001\n000100011100\n100001010000\n100000110010\n111001101000\n100011101101\n000111000101\n000011000101\n111110001011\n001111011101\n110110010100\n011010011011\n111111111010\n001010111111\n101111101001\n010000111100\n111010110111\n100100011000\n111010010110\n010100111100\n101001010000\n011100011011\n100101001110\n011100010110\n111010011100\n100110011001\n100110000110\n111010110010\n011000010111\n111101000110\n000001000011\n001011111011\n011100000111\n111011100100\n101111110000\n011111010010\n001100111000\n011001000010\n100110100111\n101000101110\n110100101100\n011101001100\n111100100011\n110101001101\n101111000110\n111010100100\n100101010101\n111011100000\n011100101010\n111111001111\n010010100001\n111001111111\n101000110101\n010001101010\n000110110011\n001010110011\n110001101001\n110110000011\n100111110011\n000100101100\n111010101100\n101011101100\n010110000100\n101001010101\n000001010011\n011110000000\n101111110011\n001010001000\n110000010001\n101010101100\n011010111010\n010100101000\n101100011011\n010010101011\n110101110001\n010101001101\n011110011001\n100000110011\n010110110000\n101100100010\n010000110100\n001000100101\n100011100011\n111000010110\n000110011000\n000011011000\n010101001000\n101000010100\n111011111011\n010110010001\n100111100011\n011011111100\n001010011110\n011110110101\n111100101110\n001001011110\n010100010111\n100011010001\n110110000111\n001000001101\n001011110001\n111001000011\n101101011101\n111000111010\n111111110001\n001100000000\n110011011010\n011010101001\n011010101011\n011010011100\n100100111110\n111001011110\n001010001101\n101101010100\n100100110100\n011000111111\n101011010100\n111010100110\n001111010010\n011001100000\n011010010100\n001100001010\n101001001111\n111011110110\n100101100001\n000100110010\n101111001001\n111001011000\n100010001101\n101101001010\n011001110001\n010110010110\n000100010100\n011011011100\n000101101011\n110010011110\n010010011010\n111110110010\n000010001111\n000010010011\n000000111010\n110001100011\n000010000100\n101011111000\n110111001001\n101111100000\n110101111000\n100010000011\n000001111111\n000110001110\n000010000000\n110110011110\n000101101000\n001101111011\n011101101100\n101100011101\n110001010100\n011010111000\n011101101010\n110010110101\n100101100000\n101001011100\n100101001010\n011110111011\n111101111100\n101000111001\n111001110001\n101100001111\n100001100111\n011001101000\n111000100101\n000000001011\n110011100011\n111010001011\n111100001011\n111101101001\n111001101110\n000110100101\n000111100001\n101101101101\n100000000011\n001100011111\n101101111110\n101010111000\n010100000001\n000110011011\n000100011000\n000001110110\n100111101001\n001111011110\n000010011110\n101001000010\n101001011111\n110011010010\n101100010110\n101110001111\n000111110011\n011011101010\n101010011010\n101100111001\n111111000000\n101100110101\n110100101101\n010000100111\n110011000001\n010001001000\n000111110000\n100101010110\n001010001001\n100100111010\n001010010110\n010111010010\n010010100000\n010110001011\n011001101011\n110001000111\n111001001000\n001101001101\n101000111100\n100011101001\n100011111010\n100000010101\n110010100110\n001000110101\n111100011011\n011001101010\n101011010000\n011111001110\n010011010111\n101100111000\n011111011010\n110110001010\n100010111110\n100001001001\n000001011101\n110001100101\n011001100111\n111001101010\n001000011001\n000011101000\n100100001001\n110001111000\n010111000101\n000111001101\n001110100010\n010110101011\n100111110001\n110000001001\n011100111001\n100111010000\n101111010000\n001110110100\n010111001010\n000100101111\n100000010010\n110110111000\n111010010001\n001101011001\n001011011100\n001001111000\n011101001011\n001101110111\n111111001000\n011001001001\n011100100111\n011011011011\n101010100111\n010101011100\n100000010110\n101101110010\n110111010001\n010000100110\n010011100011\n101111000011\n011110101011\n111101110010\n001100101111\n111101011101\n001010010001\n001110111110\n010101000010\n111010101101\n100001111000\n111100001111\n011010100000\n110001011110\n010000100001\n110001001001\n100101101011\n000010111010\n000110101101\n100110011000\n100100110111\n100010000001\n001110010000\n010001101110\n111001000000\n100010001011\n111010111010\n000100001101\n010101101000\n001101111010\n111100110100\n010010111100\n011010010110\n000001100000\n111111111001\n101001101111\n100011000110\n001100010110\n000110111110\n000001010001\n101010000011\n000110001011\n000110101011\n000011100111\n101011110110\n110100000100\n111000101101\n000100100010\n011011111001\n000010110000\n111010101010\n011000001101\n101111110001\n110101000001\n000000110011\n000100111111\n111001100100\n000011100010\n001100110001\n111000010000\n001011000000\n111000011011\n100001101001\n111100001000\n001011100000\n111101101000\n100100101111\n110110001111\n011110011110\n010011011100\n110110010001\n011001000111\n101111110101\n011101011111\n010100100010\n101101010110\n010001111111\n111110111000\n001010110101\n111000111000\n110101011010\n011001110110\n011101011001\n010100110111\n101101111111\n111111101011\n111010101111\n010000111011\n111010000111\n000100111010\n010011000100\n101010001011\n010111110110\n100001100011\n111001110100\n011000100101\n000011111111\n100101010111\n011000000110\n001011001000\n011100000000\n011110011100\n100101001001\n000001110000\n010110011110\n001111000101\n100101110001\n110111100111\n001010010000\n110011101011\n011111001011\n011010110000\n011011010110\n000111100011\n110000001010\n000010111101\n100100101001\n010100000100\n001101111100\n111000100010\n010110000001\n111010111101\n000001010100\n100100100110\n110011000000\n000111101000\n000110101110\n011101011010\n001100110011\n101011111001\n001101001011\n100110011100\n110001111001\n101101001100\n110000110011\n110000111110\n000010101010\n010001111010\n001100001001\n111000011100\n101011000001\n101000011110\n111001010101\n010001100001\n011001111001\n100010100001\n111101011110\n111110100001\n001011000011\n100010110111\n010100101110\n110001110011\n111001011111\n001101000010\n000001111110\n010011101100\n111010110000\n110001100001\n101001111001\n000101100001\n111110110110\n010010001110\n001010001111\n001010001100\n111000000010\n000101000011\n010110000101\n011111110111\n000000000111\n011101100000\n000011110010\n010110100100\n111011000101\n010111011001\n111111100011\n010111001011\n101110111110\n100001110110\n111110111100\n110011000110\n101100110111\n001000011111\n000000111111\n010100010000\n100000001111\n100010101000\n110110001101\n010101100101\n111110101111\n010010110011\n000101011000\n110001110100\n001111111010\n110100111110\n111010111111\n110100110101\n100000111111\n011011101110\n000001101000\n110011100010\n111011110101\n111100000010\n101000001110\n100101101001\n101110010111\n000001100001\n000101001111\n000101101010\n101011001010\n001100001100\n111010110110\n101100000100\n010011010011\n001000100111\n001110100001\n010101011101\n101011111101\n111110110011\n001101100000\n101111000010\n001110010101\n000111111100\n000110000100\n000101111001\n000011111000\n000010000110\n001010011000\n111111101001\n011000001111\n111010100001\n111110001111\n101110010110\n010011000011\n110001000010\n110111100110\n010100000111\n000011000010\n000000010010\n100111111011\n001011111000\n110010001100\n000111011101\n000101001010\n001100110101\n110110110000\n110111100101\n000000111000\n100011100111\n100100111101\n011011001011\n000100101000\n111101010101\n010011111101\n110100110100\n110011111011\n100111011011\n101000100100\n011000001110\n101000001000\n110101011001\n100110111100\n110010000001\n000111000011\n010001001100\n101001000100\n100000101101\n011011111010\n101000100010\n011001011111\n011001000001\n001100011010\n100011011111\n110011010111\n111000101000\n001001110110\n101010101011\n001110110110\n011111010011\n100111111010\n001111101110\n110010101000\n000001111000\n100110111101\n110110001001\n111000011111\n011111000111\n111100011000\n101001000110\n110010000010\n000100111000\n001000101000\n011100100001\n101101101010\n110110111011\n001011101100\n110111110111\n011000111101\n110000111000\n101010000101\n111010011011\n111011101010\n101100101100\n000110101000\n110011111001\n010111011000\n100101111101\n101110110000\n100001111010\n110101100001\n100010011110\n011000100100\n101110101111\n111011011110\n000110110100\n010100001100\n101001101000\n001001000010\n100110001001\n001011111100\n100011111100\n011100001011\n001100000100\n100111001011\n011101000101\n011110000100\n011011011101\n001001011010\n110110011101\n000000001100\n010111100101\n111011011101\n000100101110\n001100011001\n110001001110\n101010100001\n011101100011\n100000111000\n111111100111\n001000100011\n110000000011\n101001010010\n111101010100\n111101111110\n001110100100\n111100100010\n010000100101\n010100001101\n011010011110\n001110000110\n101000000001\n010111111000\n111111011011\n110110101010\n000000110110\n111001111010\n001110110010\n111011010110\n001100100010\n011111000100\n000111010000\n100101110111\n001011110011\n111110011011\n111001010011\n000110011100\n010111000111\n101000001100\n010101111011\n100001011011\n010100110101\n010000000000\n110010011100\n110101001110\n111010111110\n101101110101\n011010101111\n101010011110\n010111110100\n010100110011\n110110001100\n001011110100\n010001000000\n100011010110\n100111000000\n010111100000\n100010100110\n001100101101\n010111100110\n101101000100\n101110011001\n011011100101\n101101101111\n110010100000\n100100100010\n001100110000\n110110011100\n000010000001\n101001101001\n001001100110\n000101100011\n111101000111\n000110000011\n011011110000\n110010000011\n010111000001\n101101011001\n101100001001\n101100010101\n011010011111\n010100011100\n100111100111\n101110100110\n101011010101\n110110101111\n010001010101\n000010001100\n001110000001\n110011111100\n000001111001\n001000111101\n010011110001\n110100010010\n100000100101\n100100000011\n111110010000\n110010001001\n011111100001\n010011011001\n111110110001\n000011010010\n011101101011\n110011100001\n000110101111\n001111101101\n110101110000\n001000011101\n111111001100\n110101101111\n000110111000\n101100010100\n011101100100\n111000101010\n110001001011\n100010001111\n001101000111\n011000010000\n110010110001\n111100100001\n110111110110\n000010000011\n100001111110\n111001001001\n001011011101\n000100011101\n001100100111\n000011010001\n111111001110\n001111111101\n110001110001\n101010011101\n110010010101\n001011010101\n111110010011\n011001101110\n101000011100\n110100011111\n000001001111\n100001111001\n001101110110\n010111111100\n111101011111\n001111110001\n101001101110\n100100100111\n100010011100\n010110011111\n100010111011\n111011110010\n111010010011\n111001111100\n011100010011\n001010100100\n111001100101\n111100011001\n101110001011\n100000011111\n010010011000\n100001000011\n001001111101\n010111001100\n100101011101\n110011101010\n010010101110\n100011001101\n101100101001\n011110010000\n101000011010\n110100010101\n010110111110\n011110010111\n100000001000\n101000011000\n000111100111\n011001100110\n001010011001\n011011101011\n101000000110\n000100010010\n100100101011\n000101011111\n010000110101\n000000011010\n111101111001\n111011011111\n010000001001\n100101100011\n000111011001\n111011011011\n000011011001\n111101011001\n001000001100\n000110001000\n110111010010\n101100101011\n111101110001\n110101101101\n100111001110\n110010111110\n000010001010\n101101000001\n000011101111\n110000100100\n010001101001\n000000001110\n001110011101\n000100101011\n110100111100\n011000100111\n001110101101\n010101100100\n101110100000\n100110001010\n101110010000\n000111111010\n011011110101\n001111110100\n000111110110\n101011111110\n100010110000\n100100100101\n101000001101\n010011111111\n001110111001\n101010110110\n110010011011\n110001001000\n101110100011\n101001011000\n100111101110\n100111000111\n001000111100\n010101111010\n100010100101\n110011010011\n100100000111\n111010101001\n110001001101\n011000101001\n000110100001\n100011111110\n001100011000\n110100010000\n001010110100\n000100000110\n001011101010\n001100100110\n011111101011\n000101111101\n001110110101\n110000001111\n001010000011\n110101001000\n001000010001\n111011101011\n001001011101\n000001000000\n000110010101\n100110101010\n101010000111\n110101101110\n100000010011\n001110001011\n011110000010\n100000100010\n111111101100\n011010000011\n001101001110\n011100001000\n000001001110\n000111001000\n100100011010\n010000010100\n111110001100\n111100101111\n101000100101\n011100101110\n000011101101\n000100100100\n011111111001\n000100110011\n001011001011\n110101100000\n101111111011\n001101111101\n100110100011")


(defn get-binary-number-seq [str-data]
  (map #(Integer/parseInt (str %1))
       (seq str-data)))


(defn power-2 [[i x]]
  (if (= x 0)
    0
    (Math/pow 2 i)))


(defn flip-bit [bit]
  (if (= 0 bit)
    1
    0))


(def cleaned-data-day3 (map get-binary-number-seq (clojure.string/split day3-data #"\n")))


(defn get-2-sum [seq-data]
  (reduce + 0
          (map #(power-2 %)
               (map-indexed vector (reverse seq-data)))))


(defn loopy-loop [curr-map curr-val]
  (loop [x (map-indexed vector curr-val)
         res curr-map]
    (cond (empty? x)
          res
          :else
          (recur (rest x) (let [[i v] (first x)]
                            (case i
                              0 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              1 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              2 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              3 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              4 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              5 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              6 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              7 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              8 (if (= v 0)
                                        (assoc-in res [i :0] (inc (get-in res [i :0])))
                                        (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              9 (if (= v 0)
                                         (assoc-in res [i :0] (inc (get-in res [i :0])))
                                         (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              10 (if (= v 0)
                                         (assoc-in res [i :0] (inc (get-in res [i :0])))
                                         (assoc-in res [i :1] (inc (get-in res [i :1]))))
                              11 (if (= v 0)
                                   (assoc-in res [i :0] (inc (get-in res [i :0])))
                                   (assoc-in res [i :1] (inc (get-in res [i :1]))))))))))


(let [data (reduce loopy-loop {0 {:1 0 :0 0}
                               1 {:1 0 :0 0}
                               2 {:1 0 :0 0}
                               3 {:1 0 :0 0}
                               4 {:1 0 :0 0}
                               5 {:1 0 :0 0}
                               6 {:1 0 :0 0}
                               7 {:1 0 :0 0}
                               8 {:1 0 :0 0}
                               9 {:1 0 :0 0}
                               10 {:1 0 :0 0}
                               11 {:1 0 :0 0}}
                   cleaned-data-day3)
      g (for [x (range 12)]
          (let [s (get-in data [x :0])
                e (get-in data [x :1])]
            (if (> e s)
              1
              0)))
      e (map flip-bit g)]
  (* (get-2-sum g) (get-2-sum e)))


;; Part2
(def temp-data
  ["11110"
  "10110"
  "10111"
  "10101"
  "11100"
  "10000"
  "11001"])


(def cleaned-data-day3-part2 (map get-binary-number-seq cleaned-data-day3-part2))


;; consider the == case
(defn get-big [data]
  (if (= (count data) 1)
    data
    (if (> (last (first data)) (last (last data)))
      [(first data)]
      [(last data)])))


(defn get-frequent-value [data i]
  (let [inter (map frequencies (partition (count data) (apply interleave data)))
        data- (nth inter i)]
    (get-big data-)))


(loop [data cleaned-data-day3
       i 0]
  (cond (= (count data) 1)
        data
        :else
        (recur (let [d (vec (get-frequent-value data i))
                     v (first (first d))
                     c (last (first d))
                     filtered-data (filter #(= v (nth %1 i)) data)]
                 (take c filtered-data))
               (inc i))))


;; Day 4
;; Part 1

(def bingo-numbers
  (clojure.string/split "6,69,28,50,36,84,49,13,48,90,1,33,71,0,94,59,53,58,60,96,30,34,29,91,11,41,77,95,17,80,85,93,7,9,74,89,18,25,26,8,87,38,68,5,12,43,27,46,62,73,16,55,22,4,65,76,54,52,83,10,21,67,15,47,45,40,35,66,79,51,75,39,64,24,37,72,3,44,82,32,78,63,57,2,86,31,19,92,14,97,20,56,88,81,70,61,42,99,23,98" #","))

;; 22 59  7 10  6
(def bingo-data
  "
  22 59  7 10  6\n33 36 96 55 23\n13 85 18 29 28\n75 46 83 73 58\n34 40 87 56 98\n\n73 96 47 14 10\n28 11 79 84 20\n74 30  0 59 71\n80 93 42 22 17\n44  2 81 29 15\n\n73 32 37 93 39\n 2 87 38 99 97\n15 12 42 49 33\n 9 23 25 94 19\n57  4 18 70 79\n\n43 79 59 71 78\n51 97 37 28 26\n46 21 84  8 86\n96 30 17 34 49\n55 90 99 75 61\n\n43 86 35 51 24\n16 25 29 21  3\n 2 13  4 36 54\n89 27  8 85 34\n96 59 65 14 56\n\n 5 57 43  4  1\n86 80 67 30 20\n22 16 99  0 14\n40 25 59 91 54\n82 95 96 37 24\n\n97 20 87 66 21\n25 40  9 78 89\n52 75 95 63 62\n32 43 13 47 69\n53 48 56 29  4\n\n24  4 65 12  8\n76  3 81 99 49\n45 33 31 66 34\n17 94 75 35 88\n64 10  7 93 95\n\n88 20 99 15 83\n81 40  5  6 98\n49 74 18 27  9\n43 69 28 37 71\n87 82 90 14 47\n\n21 97 92 42 60\n11 65 98 95 29\n 2 49 75 20 74\n56 40 78 66 81\n68  4 46 77 61\n\n26 14 39 76 11\n41 74 34 91  4\n51  9 97 29 75\n83 86 23 35 77\n90  2 49 30 89\n\n34 97  0 22 15\n65 60 82 66 47\n30  9 49 95 48\n54 73 67 17 78\n33 96 44  1 32\n\n90 29 10 49 63\n 8 26 95 61  0\n54 13 51 12 44\n32 48 16 47 84\n55 46 93 14  3\n\n68 55 46 16 54\n97 59 49  6 21\n52 32 15 96 70\n57 56 61 51  0\n40 31 62 24 48\n\n75 56 70 42 14\n77  9 23 62 25\n29 27 54 17  2\n55 72 43 15 96\n45 30 88 86  1\n\n65 12 22  6 51\n77 81 15 91 19\n80 71 27 89 52\n75 92 41 83 57\n40 44 66 84 98\n\n89 80 73 59 18\n74 55 67 71 10\n78 27 37 57  3\n92 26 17  5 72\n52 83 28 76 51\n\n64  0 87  4 13\n14 43 42 62 31\n17 84 72 91 83\n53 80 59 61 74\n47 22 38 28 77\n\n65 49 91 94 19\n25 81 64 57  9\n50 95 82 12 66\n53 54 85 36 11\n31 56 83 18 60\n\n 6 12 76 37 33\n14 96 16 31 40\n17 82 27 94 83\n 1 50 49  9 54\n29 70 59 91 77\n\n85  0 33 41 16\n 7 86 80 53 65\n94 19 28 35 32\n 4 55 93 97 63\n83 22 67 56 36\n\n28 70 65 17 19\n88 51 15 73 12\n11 49 80 23 42\n26 54 90 75 29\n74 77 91 86 66\n\n88 22 83 10 43\n57 34 15 23  8\n94 42 68 67 37\n84  3  6 71 62\n89 45 72 55 38\n\n68 27 93  7 15\n85 96  1 56  6\n32  2 30 55 17\n99 90 37 80 50\n77 78 58 98 57\n\n 5 95 22 13 97\n19  2 52 92 20\n75 49 86 31 41\n51 63 56 33 10\n82 27 79 94 57\n\n15 44 91 26  4\n41 78 53 95 86\n90 92 46 56 33\n80 93 68 66 70\n36 10 38  0  6\n\n11 47 52 64 17\n16 60 39 55 78\n46 18 33 83 35\n13 92  4 23 50\n40  5 29  6 90\n\n20 60  2 23 74\n43 39 91 75 12\n58 67 50 29 79\n10 40 92 95 25\n13 24 53 72 36\n\n69 64 15 53 86\n61 11 48 71 27\n26 93 38 70 73\n96 29 30 98 45\n13  7 31 59 84\n\n13 55 50 54 57\n32 24 45  5 77\n82 86  0  4 99\n75 72 14 40 56\n76 94 89 17 30\n\n66 71 86 41  0\n80 64  3 29 78\n23 21 42 99 87\n96 60 75 61 49\n 2 83 85 12  1\n\n78 96  4 82  6\n73 36 57 99  8\n11 83 15 35 30\n85 87 25 22 66\n32 64 16 50 43\n\n 6 39 55  2  4\n 1 61 99 71 80\n46 88 22 31 60\n62 66 37 97 76\n74 34 10 52 24\n\n42 38 13 65 12\n 4 39 60 62 21\n81 99  1 69 40\n59 15 11 95 53\n91 78 72 30 73\n\n43 68 82 72  2\n34 92 33 97 89\n63 70  9  0 45\n69 10 12 65 21\n40 20 55 57 49\n\n41 22  8 16 49\n71 64 19 65 92\n17 10 26 36 29\n30 88  7 54 11\n77 55 70 72 47\n\n15 94 90  6 39\n99 55 16 54 91\n18  7 82 44 51\n25 34 83 14 12\n30  2 77 27 66\n\n44 50 74 97 58\n87 42 56 92 28\n49 82 52 17 78\n54 89 63 77 27\n83 14 24 16 84\n\n47 32  8 55 22\n19 14 24 82  4\n76 73  9 10 64\n40  6 92 67 17\n68 44 43  3 54\n\n26 10  9 92 81\n46 98 13  0 14\n68 99 35 18 72\n74 33 22 61 93\n80 38 71  6 75\n\n17 23 54 55 22\n10  8 60 76 24\n71 28 16 62 82\n13 12 21 78 39\n26 66 89 64 79\n\n72 12 91 79 99\n84 18 37 98 41\n10 71 88 23 24\n11 34 26 83 74\n58 27 77  5  8\n\n 9 90 13  0 46\n 6 58 74 92  8\n75 77 56 76 80\n55 60 44 68 91\n67 28 96 66 18\n\n14 26 54 21 35\n69 67 16 76 62\n78 45 87 44 94\n27 89 39 85 28\n 3 81 93 64 74\n\n10 28 35 84 76\n40 11 95 59 57\n53  4 24 50 45\n 7 43 78 17 81\n 1 74 82 16 27\n\n 6 26 72 53 52\n51 91 80 11 18\n20 63 74 25 33\n79  4  8 59 67\n 3 13 55 81 83\n\n98 85 27 84 42\n90 15 17 61 34\n40 64 86 96 45\n59 47 53  5 35\n11  7 41 80 13\n\n47 48 54 31 76\n99 32 98 20 15\n61 41 30 94 37\n34 59 86 55 45\n 9 83 92 53  3\n\n 3 80 24 94 25\n17 23 64 76 71\n20 97  0 56 72\n95 73 28 59 21\n14 81 46 67 88\n\n 2 95  5 38 90\n63 62 11 24 34\n19 31 57 84 80\n47 86 36 85 74\n13 39 73 94 42\n\n28  6 60 34 15\n63 36 51 30 92\n43 10  7 88 49\n78 76 31 19 66\n22 20 35 45 79\n\n19 42 49 57 73\n99 50 97 93 43\n67 52 40 16 33\n 2 55  0 71 46\n21 75 59 66 83\n\n19 86 30 25  3\n32 39 65 54 29\n38  6 85 52 13\n43 95 18 44 15\n53 70 16 31 71\n\n68 73 74 83 70\n56 15 12 78  4\n43 87 63 90 86\n41 16 23 17 77\n80 14 61 30 50\n\n88 28 45 80 65\n64 11 68 33 27\n29 70 44 82 37\n42 66  9 32 87\n10 24 15  3 46\n\n99 81  5 62 97\n 4 36 23 38 35\n42 16 37 98 54\n34 41 25 30 48\n 8 60 63 89 72\n\n25 33 94 23 14\n45 10 79 30  3\n22 28 95 27 11\n74 13 39 84 83\n72 88 56 53 97\n\n31 92 91 84 71\n54 90 89 80  0\n98 96 65 66 68\n35 39 70 11 82\n15 34 42 52  2\n\n68 71 86 82 37\n28 48 12 34 54\n62 55 10 25 89\n60  4 50 21 22\n 3  2 18 40 84\n\n18 96 95 47 45\n14 51  2 88 43\n94 56 19 15  8\n48 65 62  6 75\n35 28 25 72 30\n\n43 85 69 92 26\n61 75  5 73 66\n16 87  4 99 48\n18 19 79 23 83\n37 88 31 38 40\n\n23 10 89 84 76\n45 39 62 55 66\n25 73 79 43 60\n12 69 36 93 71\n 9 77 14 58 49\n\n 9 24 26 53 79\n99 15 30 50 16\n14 95 12 25 33\n54 40 58 46 66\n 5 23 39 29 48\n\n64 67 11 10 92\n59 99 80 97 66\n45 51 88 47 82\n35 27 72 85 16\n54 58  2  1 52\n\n10 97 27 54 66\n89 85 39 99 98\n 8 68 95 51 19\n 4 17 79 87  3\n72 43 76 58 33\n\n95 72  0 18 17\n 3 42 24 86 34\n52 79 46 58 98\n76 77 78 19 10\n81 61 88 85 54\n\n74 70 15 80 72\n77 89 11 19 22\n34 59 56 65 91\n58  6 50 40 16\n93 30 95 26 85\n\n47 62 57  6 25\n40 79 22 95 29\n42 11 70 10 92\n60 53 84 96 17\n75 86 74 89 18\n\n30 42  4 19 92\n40 58 72  7 70\n17 98 45 76 50\n93 57 65 79  2\n56 94 73 84 62\n\n51  0 14  7 53\n63 36 48 81 84\n50 22 11 88  6\n83 99 21 31 91\n86 17 72 42 94\n\n83  0 20 26  7\n42 24 37 86 65\n73 82 63 21 27\n30 35  9 47 80\n79 53  3 14 84\n\n50 99 83 86 42\n81 36 24  4 76\n 0 71 66 41 57\n 7 54 94 78 97\n12  8 82 45 31\n\n 4 91 57 50 37\n22 46 86 24 26\n39 54 48  7 42\n 2 45 95 29 12\n38 25 52  0 72\n\n51 94 46 44 62\n95 60  0 48 61\n38 13 85 32  8\n22 56 53 30 80\n43 65 58 68 88\n\n49 76 41 43 51\n57 46 45 82 90\n48 33 36  5 23\n81 30  3 61 75\n56 70 29 91 59\n\n58 74 50 47 84\n 2  1 62 36 60\n32 16 95 43 27\n79 12 39 56 11\n 9 33  4 25 61\n\n23 84 16 51 39\n72 19 53 64 43\n 9 44 10 52 26\n45 68 29 56 74\n62 42 46 95  0\n\n16 83 27 85 56\n13 41 49 79 53\n18 63  7 60  3\n45 15 48 69 29\n46 86 35 34 32\n\n85  2 96 15 43\n33 30 29 53 98\n21 55 61 73 40\n31  4 66 75 59\n26 32 91 38 80\n\n69 81 65 30 77\n82 22 83  0 38\n 2  3 29 47 94\n42 55  9 18 97\n53 45 90 31 44\n\n23 86  0 35 84\n27 80  3 64 12\n 1 96 48 93 85\n69 24 61 15 22\n91 72 62 13 76\n\n81 51 67 60 16\n65 48 86 39 97\n92 93 49 77 59\n15 94 88 52 19\n80 83 23 61  4\n\n47 84 46 79 55\n92 38 65 42 76\n 9 58 26 95 86\n30 49 56 69 59\n94  4 25 89 44\n\n73 10 29  0 48\n56 40 19 84 61\n52 31 25 86 21\n79 55 53 51  5\n81  9 35 72 15\n\n41 95 30 58 73\n26 80  4 21 96\n61 92 76 93 74\n 2 69 60  8 20\n46 98 70 72 83\n\n 1 99 31  4 86\n93 64  8 43 61\n33 36 75 90 50\n52 13  3 42 34\n22 65 60 18 76\n\n17 63  6 66 92\n51 67 86 88 18\n82 83 32 74 30\n 5 33  9 28 61\n72 75 25 23 60\n\n43 28 40 53 52\n54 12 77 10 83\n21 44 63  0  1\n15 22 33 49  2\n80 41  3 46 55\n\n 1 97 75 37  4\n47 33 13 21 40\n27 62 15 90 30\n11 83 63 36 35\n 0 12 60 91 42\n\n 0 45 17 88 18\n66 10 63 62  8\n36  5 47 39 67\n21  3 61 29 19\n82 58 33  6 59\n\n37 92 69 56 52\n46 66 20 78 13\n83 99 16 31  0\n36 35  2 68  9\n70 82 94 96 29\n\n62 65 85 37  3\n74 95 34 96 58\n15 33 49 21 93\n19 83 66  6 25\n81 84 23  0 76\n\n95 84 71 92 52\n54 36 66 59 82\n 0 76 32 45 83\n69 27 25 88 38\n81 96 63  4 61\n\n73 51 28 48 40\n 3 38 11 14 35\n66 91 86 20 81\n53 39 46 71  1\n97 60 21 93 23\n\n92 70  4 60 95\n58 49 20 15 25\n55 68 21 84 80\n56 41 82 23 19\n30 74 65 27 29\n\n81 97 68 46 75\n62 73 63 36 41\n 1  5 91 84 37\n45 92 20 49  7\n25 26  3 88 56\n\n25  9 94 37 26\n44 58 84 91 38\n39 46 57 98 50\n96 42 73 24 70\n71 32 53 48 13\n\n98 72 25 96 77\n80 64 88 53 23\n21 37 45 24 18\n41 86 59 68  5\n76 50 36 26 12\n\n77 79 88 74 12\n21  9 85 26 68\n11 62 64  4  5\n47 33 76 63 87\n55 19  2 60 95\n\n74 79 30 14 35\n90 52 17 29 63\n18 69 78 34 26\n92 42 85 71 56\n12  2  5  0 98
  ")


(def temp-data-part4 (partition 5 (filter #(not= "" %1)
                                          (map #(clojure.string/trim %1) (clojure.string/split bingo-data #"\n")))))

(defn remove-crap [data]
  (let [split-data (clojure.string/split data #" ")
        filter-split-data (filter #(not= "" %1) split-data)]
    (vec filter-split-data)))


(def matrix-data
  (for [x temp-data-part4]
    (map remove-crap x)))


(defn replace-match-item [data m]
  (let [i (.indexOf data m)]
    (if (not= i -1)
      (assoc data i "-1")
      data)))

(for [x (take 5 matrix-data)]
  (map #(replace-match-item %1 "10") x))

(defn is-row-winner [data]
  (let [x (for [x (map #(set %1) data)]
            (count x))]
    (not= -1 (.indexOf (vec x) 1))))
;(is-row-winner (first matrix-data))

(defn is-col-winner [data]
  (let [transpose (partition (count (first matrix-data)) (apply interleave data))]
    (is-row-winner transpose)))

(defn is-winner? [data]
  (let [r-winner (is-row-winner data)
        c-winner (is-col-winner data)]
    (if (or r-winner c-winner)
      data)))

"
1. get the data
2. replace items
3. check for winner
4. if winner exit or else loop
"

(defn get-sum [data curr-val]
  (let [winner-matrix (filter #(not-empty %1) (for [x data] (filter #(not= "-1" %1) x)))
        int-winner-matrix (for [x winner-matrix]
          (map #(Integer/parseInt %1) x))]
    (* (Integer/parseInt curr-val) (reduce + (map #(apply + %1) int-winner-matrix)))))


(let [x (loop [data matrix-data
               drawn-numbers bingo-numbers]
          (let [curr-val (first drawn-numbers)
                updated-data (for [x data] (map #(replace-match-item %1 curr-val) x))
                winner (filter #(not= nil %1) (map is-winner? updated-data))]
            (cond (and (not-empty winner) (not= true (nil? winner)))
                  [(vec (first winner)) curr-val]
                  :else
                  (recur updated-data (rest drawn-numbers)))))]
  (get-sum (first x) (last x)))

